---
title: "Autonomics for Proteomics"
author: "Aditya M Bhagwat"
date: "`r Sys.Date()`"
output: BiocStyle::html_document
vignette: >
  %\VignetteIndexEntry{autonomics_for_proteomics}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, collapse = TRUE, cache = TRUE, fig.show = 'hold', fig.align = 'center')
```

This vignette demonstrates how to use `autonomics` for proteomics data analysis.


# Dataset

Fukuda et al. (2020) studied the embryonic development of zebrafish.  
They compared the proteome of 30-days-post-fertilization embryos to adults.


```{r, message = FALSE}
require(autonomics)
file <- download_data('fukuda20.proteingroups.txt')
object <- read_proteingroups(file, plot = FALSE)
sdt(object)[, 1:3]
```

# Filtered Features

```{r}
n <- analysis(object)$nfeature   # Filtering details
```

MaxQuant identified `r n[[1]]` proteingroups.  Filtered out were `r n[[1]]- n[[2]]` reverse hits, `r n[[2]] - n[[3]]` potential contaminants, `r n[[3]]-n[[4]]` proteingroups without quantitative value (for any sample) and `r n[[4]]-n[[5]]` without replication (within subgroup). This retained **`r n[[5]]` proteingroups** for further analysis.  


# Missingness: systematic versus random

```{r}
systematic <- sum(is_missing_systematically(object))
random     <- sum(is_missing_randomly(object))
not        <- sum(is_not_missing(object))
```


**`r systematic`** proteingroups are **missing systematically**: they are missing (completely) in some subgroups but detected in other subgroups (for at least half of the samples). These proteingroups represent potential switch-like responses. They require prior imputation for statistical analysis to return pvalues. The label  systematic is probable but not certain, and increasing sample size helps to increase confidence as to whether the missingness is truly missing systematic.  
**`r random`** proteingroups are **missing randomly**. They are missing in some samples, but the missingness is unrelated to subgroup. These samples do not require require imputation for statistical analyis to return pvalues.  
**`r not`** proteingroups are **not missing** (at all). They are present in all samples.

Missingness plots provde an excellent summary:

```{r, echo = TRUE, results = 'hide', message = FALSE, fig.width = 6, fig.height = 3, out.width = '100%', out.height = '100%', fig.cap = 'Left: plot_missingness_per_sample, Right: plot_misingness_per_subgroup'}
p1 <- plot_missingness_per_sample(object) + ggplot2::guides(fill = 'none')
p2 <- plot_misingness_per_subgroup(object)
gridExtra::grid.arrange(p1, p2, nrow = 1)
```

`plot_missingness_per_sample` (left) shows systematic and random missingness 
(white), and full detection (bright color) at sample resolution.
Imputations are also shown (light color).

`plot_missingness_per_subgroup` (right) shows systematic missingness at subgroup resolution.
Random missingness and full detection are grouped together (bright color).
Imputations are also shown (light color).

# Imputation

Proteingroups with systematic misses require prior imputation for statistical analysis to return pvalues (rather than missing values). 

```{r, echo = TRUE, results = 'hide', message = FALSE, fig.cap = 'Left: sample distributions, Right: detections'}
impute(object, plot = TRUE)
```
The sample distributions (left) show how imputed values are drawn from a normal distribution, 2.5 standard deviations away from the sample mean, 0.3 standard deviations wide.  

The detection plot (right) shows imputed values with a lighter color.

# Principal Component Analysis 

```{r, echo = FALSE, results = 'hide', message = FALSE, fig.width = 4, fig.height = 4, out.width = '50%', out.height = '50%', fig.width = 5, fig.height = 4}
biplot(pca(object))
```
