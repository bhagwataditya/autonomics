<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Convert SummarizedExperiment into data.table — sumexp_to_wide_dt • autonomics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Convert SummarizedExperiment into data.table — sumexp_to_wide_dt" />
<meta property="og:description" content="Convert SummarizedExperiment into data.table" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">autonomics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/using_autonomics.html">autonomics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bhagwataditya/autonomics/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Convert SummarizedExperiment into data.table</h1>
    <small class="dont-index">Source: <a href='https://github.com/bhagwataditya/autonomics/blob/master/R/2_sumexp_to_dt.R'><code>R/2_sumexp_to_dt.R</code></a></small>
    <div class="hidden name"><code>sumexp_to_long_dt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Convert SummarizedExperiment into data.table</p>
    </div>

    <pre class="usage"><span class='fu'>sumexp_to_wide_dt</span><span class='op'>(</span>
  <span class='va'>object</span>,
  fid <span class='op'>=</span> <span class='st'>"feature_id"</span>,
  fvars <span class='op'>=</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/setops.html'>intersect</a></span><span class='op'>(</span><span class='st'>"feature_name"</span>, <span class='fu'>autonomics</span><span class='fu'>::</span><span class='fu'><a href='fvars.html'>fvars</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span><span class='op'>)</span>,
  assay <span class='op'>=</span> <span class='fu'>assayNames</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
<span class='op'>)</span>

<span class='fu'>sumexp_to_long_dt</span><span class='op'>(</span>
  <span class='va'>object</span>,
  fid <span class='op'>=</span> <span class='st'>"feature_id"</span>,
  fvars <span class='op'>=</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/setops.html'>intersect</a></span><span class='op'>(</span><span class='st'>"feature_name"</span>, <span class='fu'>autonomics</span><span class='fu'>::</span><span class='fu'><a href='fvars.html'>fvars</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span><span class='op'>)</span>,
  sid <span class='op'>=</span> <span class='st'>"sample_id"</span>,
  svars <span class='op'>=</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/setops.html'>intersect</a></span><span class='op'>(</span><span class='st'>"subgroup"</span>, <span class='fu'>autonomics</span><span class='fu'>::</span><span class='fu'><a href='svars.html'>svars</a></span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span><span class='op'>)</span>,
  assay <span class='op'>=</span> <span class='fu'>assayNames</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/setops.html'>intersect</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='st'>"is_imputed"</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>sumexp_to_subrep_dt</span><span class='op'>(</span><span class='va'>object</span>, subgroup <span class='op'>=</span> <span class='va'>subgroup</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>sumexp</p></td>
    </tr>
    <tr>
      <th>fid</th>
      <td><p>fvar carrying feature id</p></td>
    </tr>
    <tr>
      <th>fvars</th>
      <td><p>additional fvars to include in table</p></td>
    </tr>
    <tr>
      <th>assay</th>
      <td><p>matrix in assays(object) to be used</p></td>
    </tr>
    <tr>
      <th>sid</th>
      <td><p>svar carrying sample id</p></td>
    </tr>
    <tr>
      <th>svars</th>
      <td><p>additional svars to include in table</p></td>
    </tr>
    <tr>
      <th>subgroup</th>
      <td><p>subgroup (sym)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>data.table</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<ul>
<li><p><code>sumexp_to_wide_dt</code>:   feature          x sample</p></li>
<li><p><code>sumexp_to_subrep_dt</code>: feature.subgroup x replicate</p></li>
<li><p><code>sumexp_to_long_dt</code>:   feature.sample</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Stem cell comparison</span>
    <span class='va'>file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='download_data.html'>download_data</a></span><span class='op'>(</span><span class='st'>'billing16.proteingroups.txt'</span><span class='op'>)</span>
    <span class='va'>invert_subgroups</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'EM_E'</span>, <span class='st'>'BM_E'</span>, <span class='st'>'EM_BM'</span><span class='op'>)</span>
    <span class='va'>object</span> <span class='op'>&lt;-</span> <span class='fu'><a href='.read_maxquant.html'>read_proteingroups</a></span><span class='op'>(</span><span class='va'>file</span>, invert_subgroups <span class='op'>=</span> <span class='va'>invert_subgroups</span>,
                  plot<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>	Read C:\Users\abhagwa\AppData\Local\autonomics\autonomics\Cache/46a4141f7b55_billing16.proteingroups.txt</span></div><div class='output co'>#&gt; <span class='message'>		Infer subgroup from sample_ids</span></div><div class='output co'>#&gt; <span class='message'>		Replace NaN-&gt;NA for 12544/77643 values (in 2226/8627 features of 9/9 samples)</span></div><div class='output co'>#&gt; <span class='message'>		Log2 transform</span></div><div class='output co'>#&gt; <span class='message'>		Invert subgroups EM_E, BM_E, EM_BM</span></div><div class='output co'>#&gt; <span class='message'>			exprs    : -3.8 -&gt; 3.8</span></div><div class='output co'>#&gt; <span class='message'>			subgroups: EM_E -&gt; E_EM</span></div><div class='output co'>#&gt; <span class='message'>			sampleids: EM_E.R1 -&gt; E_EM.R1</span></div><div class='output co'>#&gt; <span class='message'>		Order on subgroup</span></div><div class='output co'>#&gt; <span class='message'>	Filter features</span></div><div class='output co'>#&gt; <span class='message'>		Retain 8528/8627 features: ~Reverse != "+"</span></div><div class='output co'>#&gt; <span class='message'>		Retain 8408/8528 features: contaminant != '+'</span></div><div class='output co'>#&gt; <span class='message'>		Retain 7877/8408 features: non-zero, non-NA, and non-NaN for some sample</span></div><div class='output co'>#&gt; <span class='message'>		Filter 7165/7877 features: expr != 0 for at least two samples in some subgroup</span></div><div class='output co'>#&gt; <span class='message'>	Transform exprs</span></div><div class='input'>    <span class='fu'>sumexp_to_wide_dt</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       feature_id feature_name     BM_EM.R1    BM_EM.R2    BM_EM.R3     E_BM.R1
#&gt;    1:          0        RBM47  0.135797512  0.36421775 -0.08672185  3.01952130
#&gt;    2:          1        TTC26  0.471759742  1.78667138 -0.12173765 -0.23216954
#&gt;    3:          2         UBA6  0.282024581  0.34422687  0.11822681  0.09578953
#&gt;    4:          3        ESYT2  0.588132944  0.84718057  0.58851677 -1.28486943
#&gt;    5:          4    UHRF1BP1L  0.161823203  0.90522344  0.52516685 -0.33159058
#&gt;   ---                                                                         
#&gt; 7161:       8620        ACIN1 -0.223676992 -0.17440642 -0.10551979  0.11469116
#&gt; 7162:       8621               0.009203827  0.05713648 -0.42784763  0.70618224
#&gt; 7163:       8622               0.280362490  0.15169856 -0.19313980 -0.58890049
#&gt; 7164:       8623        RPS10 -0.509737951  0.89665679 -0.35188434 -0.03745251
#&gt; 7165:       8624               0.661293556  1.64805513  0.91808087 -1.80900277
#&gt;           E_BM.R2    E_BM.R3     E_EM.R1     E_EM.R2     E_EM.R3
#&gt;    1:  3.08302610  2.6421239  3.79748323  3.65433566  2.57247741
#&gt;    2:  0.36446037  0.1843438  0.25504672  1.88517991 -0.36914725
#&gt;    3: -0.32261354 -0.2207151  0.33783097 -0.01235413 -0.08681377
#&gt;    4: -0.73535548 -1.2154793 -0.92941229 -0.21871918 -0.84339628
#&gt;    5:  0.50039417  0.2242873 -0.34891224  1.30878746 -0.10238781
#&gt;   ---                                                           
#&gt; 7161: -1.50996392 -1.7052411 -0.21747890 -1.47969621 -2.00179005
#&gt; 7162:  1.35957739  1.6610655  0.92779814  1.37650767  1.28380327
#&gt; 7163: -0.08399733 -0.3783443 -0.07244885 -0.05658353 -0.98279071
#&gt; 7164:  0.53196778  1.4550181 -0.55846357  0.72225324  0.62816700
#&gt; 7165: -1.47405142 -2.1073681 -1.16722945 -0.83979838 -0.97293090</div><div class='input'>    <span class='fu'>sumexp_to_long_dt</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        feature_id feature_name sample_id subgroup      value
#&gt;     1:          0        RBM47  BM_EM.R1    BM_EM  0.1357975
#&gt;     2:          1        TTC26  BM_EM.R1    BM_EM  0.4717597
#&gt;     3:          2         UBA6  BM_EM.R1    BM_EM  0.2820246
#&gt;     4:          3        ESYT2  BM_EM.R1    BM_EM  0.5881329
#&gt;     5:          4    UHRF1BP1L  BM_EM.R1    BM_EM  0.1618232
#&gt;    ---                                                      
#&gt; 64481:       8620        ACIN1   E_EM.R3     E_EM -2.0017901
#&gt; 64482:       8621                E_EM.R3     E_EM  1.2838033
#&gt; 64483:       8622                E_EM.R3     E_EM -0.9827907
#&gt; 64484:       8623        RPS10   E_EM.R3     E_EM  0.6281670
#&gt; 64485:       8624                E_EM.R3     E_EM -0.9729309</div><div class='input'>    <span class='fu'>sumexp_to_subrep_dt</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        feature_id subgroup          R1         R2          R3
#&gt;     1:          0    BM_EM  0.13579751  0.3642178 -0.08672185
#&gt;     2:          0     E_BM  3.01952130  3.0830261  2.64212392
#&gt;     3:          0     E_EM  3.79748323  3.6543357  2.57247741
#&gt;     4:          1    BM_EM  0.47175974  1.7866714 -0.12173765
#&gt;     5:          1     E_BM -0.23216954  0.3644604  0.18434378
#&gt;    ---                                                       
#&gt; 21491:       8623     E_BM -0.03745251  0.5319678  1.45501810
#&gt; 21492:       8623     E_EM -0.55846357  0.7222532  0.62816700
#&gt; 21493:       8624    BM_EM  0.66129356  1.6480551  0.91808087
#&gt; 21494:       8624     E_BM -1.80900277 -1.4740514 -2.10736806
#&gt; 21495:       8624     E_EM -1.16722945 -0.8397984 -0.97293090</div><div class='input'>
<span class='co'># Glutaminase</span>
   <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>
   <span class='va'>file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='download_data.html'>download_data</a></span><span class='op'>(</span><span class='st'>'atkin18.metabolon.xlsx'</span><span class='op'>)</span>
   <span class='va'>object</span> <span class='op'>&lt;-</span> <span class='fu'><a href='.read_metabolon.html'>read_metabolon</a></span><span class='op'>(</span><span class='va'>file</span>, plot<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>	Read: C:\Users\abhagwa\AppData\Local\autonomics\autonomics\Cache/46a459efbda_atkin18.metabolon.xlsx</span></div><div class='output co'>#&gt; <span class='message'>		Infer subgroup from sample_ids</span></div><div class='output co'>#&gt; <span class='message'>		Log2 transform</span></div><div class='input'>   <span class='fu'>sumexp_to_wide_dt</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      feature_id                   feature_name   t0.C01   t0.C02   t0.C03
#&gt;   1:      48762 1,2,3-benzenetriol sulfate (2) 17.41188 18.89120 23.06114
#&gt;   2:      34404           1,3,7-trimethylurate       NA 20.18044 18.70176
#&gt;   3:      32391              1,3-dimethylurate 17.90141 20.80406 19.42451
#&gt;   4:      20675   1,5-anhydroglucitol (1,5-AG) 28.51307 27.53302 28.65313
#&gt;   5:      21049             1,6-anhydroglucose 18.23215 19.14921 17.34008
#&gt;  ---                                                                     
#&gt; 971:      48992                      X - 23293 20.12098 22.91981 22.94148
#&gt; 972:      48993                      X - 23294 21.65979 22.65721 21.34077
#&gt; 973:      49014                      X - 23314 16.54950       NA 20.48317
#&gt; 974:      49260                      X - 23400 17.24957 18.24017       NA
#&gt; 975:      49562                      X - 23685 14.96633 19.30498 23.02848
#&gt;        t0.C04   t0.D05   t0.D06   t0.D08   t0.D09   t0.C10   t0.D11   t0.C12
#&gt;   1: 24.10870 19.50892 19.20483 22.55072 20.54472 19.46696 18.85845 16.64318
#&gt;   2: 20.37218 19.18485 19.45492       NA 16.91111 19.36820 19.20980 16.31320
#&gt;   3: 21.22118 19.73142 19.33812 17.33676 13.80917 19.72626 19.76971 17.94672
#&gt;   4: 28.31721 27.42040 26.91211 26.59909 27.75972 27.76916 27.48672 27.54434
#&gt;   5: 19.71116 17.11835 17.26326 18.36847 19.42805 20.26553       NA 18.68236
#&gt;  ---                                                                        
#&gt; 971: 22.68625 23.58425 22.73619 23.49844 21.41416 23.20464 23.31952 22.34933
#&gt; 972: 21.76910 22.18287 22.01607 22.79763 19.43041 21.39661 20.97164 21.40639
#&gt; 973: 20.72056 16.32859 17.30186 13.16616 15.33710 23.45390 15.90242       NA
#&gt; 974:       NA 19.08022       NA 17.71770 18.77814 17.69043 16.82172       NA
#&gt; 975: 19.39395       NA 19.26684       NA       NA 20.13562 17.61116 18.17484
#&gt;        t0.D14   t0.C15   t0.D16    t0.D17   t0.D18   t0.D19   t1.C01   t1.C02
#&gt;   1: 22.48337 24.30139 19.08502 18.710598 22.42675 19.79482 15.99539 19.37442
#&gt;   2:       NA 17.94359 18.77779        NA 17.47769       NA       NA 17.85528
#&gt;   3: 18.00786 18.95054 19.39499 18.100457 19.30819       NA 18.18949 19.85158
#&gt;   4: 27.13981 28.37312 28.58788 26.715590 24.34521 27.26543 28.35929 27.63929
#&gt;   5: 19.22197 19.61224 18.09976 17.714178 18.30897 19.09855 18.19224 19.12351
#&gt;  ---                                                                         
#&gt; 971: 22.76378 22.37015 23.18952 23.486105 22.53842 22.16311 20.39085       NA
#&gt; 972: 21.29269 21.98570 21.94305 22.313323 21.19051 19.52181 21.55063 22.48266
#&gt; 973: 18.07237 21.18000 15.43791  9.918863 16.10128 21.59653 17.38354       NA
#&gt; 974: 18.53968 17.93942 18.50509 19.463710 18.51108 19.53770 16.78492 18.39017
#&gt; 975: 19.78836 21.05275 19.72931 19.097435 17.27134 15.32418 15.08879 18.49344
#&gt;        t1.C03   t1.C04   t1.D05   t1.D06   t1.D08   t1.D09   t1.C10   t1.D11
#&gt;   1: 22.08304 22.94208 18.31561 18.31305 21.29198 20.53286 19.64644 17.63573
#&gt;   2: 18.36824 19.76062 18.43086 19.11802       NA       NA 18.35846 17.58830
#&gt;   3: 19.68637 21.11380 19.42593 19.40640       NA       NA 19.45756 19.44361
#&gt;   4: 27.87171 28.15472 28.12404 26.72026 26.42866 26.79411 27.82929 28.22952
#&gt;   5: 17.21391 19.48473 18.06050 18.00229 18.27355 19.10051 19.56004 17.86092
#&gt;  ---                                                                        
#&gt; 971: 19.61035 20.47783 21.98963 19.89020       NA 19.64836 19.19513 22.00149
#&gt; 972: 20.95633 21.24184 22.28356 21.90643 22.37121 19.86158 21.13611 21.58426
#&gt; 973:       NA 20.33186 16.98556 17.08793 14.70811 13.54146 22.60083 16.48989
#&gt; 974: 18.22003       NA 18.03435 18.04021       NA 17.17181 17.48468 17.52903
#&gt; 975: 22.66753 19.23717       NA 19.26985       NA       NA 19.98877 17.77221
#&gt;        t1.C12   t1.D14   t1.C15   t1.D16   t1.D17   t1.D18   t1.D19   t2.C02
#&gt;   1: 17.73968 20.23876 22.62682 18.25009 17.83637 20.70378 19.34543 18.20491
#&gt;   2: 16.11914       NA 15.07146 18.24767       NA 16.83204       NA 17.08664
#&gt;   3: 18.28719 17.82594 18.87376 19.41155 17.20507 19.15787       NA 19.54479
#&gt;   4: 27.58559 27.07923 27.49932 28.49177 27.48267 24.19404 28.11895 28.18007
#&gt;   5: 18.73323 18.10864 19.55632 17.50666       NA 18.14862 18.80228 18.94786
#&gt;  ---                                                                        
#&gt; 971: 17.13473 19.33799       NA 19.63301       NA 21.68524 19.91999       NA
#&gt; 972: 20.98388 20.97750 21.32179 21.61609 22.93187 21.33131 19.91736 22.08188
#&gt; 973:       NA 16.61071 20.80556       NA       NA 15.52592 21.16689       NA
#&gt; 974:       NA 15.74094 15.88653 17.70755 19.04558 17.90713 17.91708       NA
#&gt; 975: 18.28587 19.75170 20.98889 19.24164 19.11978 15.90164 17.45970 17.94223
#&gt;        t2.C03   t2.C04   t2.D05   t2.D06   t2.D08   t2.D09   t2.C10   t2.D11
#&gt;   1: 20.90294 21.94360 17.86405 16.24049 20.69028 20.27478 19.16262 16.95844
#&gt;   2: 17.61187 19.75917 18.85866 18.98099       NA       NA 18.29010 17.46530
#&gt;   3: 19.64307 21.37942 19.28953 19.99574 17.33215       NA 19.88787 19.47673
#&gt;   4: 27.82555 28.19164 28.10407 26.66253 26.32062 26.75519 27.81326 28.20570
#&gt;   5: 18.01936 19.21678 17.69253 17.23737 17.28693 18.66071 19.31911 17.68313
#&gt;  ---                                                                        
#&gt; 971:       NA 20.02368 21.36126 20.29311       NA 20.20951 18.61939 22.65731
#&gt; 972: 20.79457 21.26789 22.34611 21.86330 22.35066 20.22778 20.84800 21.64680
#&gt; 973: 19.85434 20.22987 14.85920       NA 14.73185       NA 22.70287 15.61727
#&gt; 974:       NA 17.76020 17.98769 17.94915       NA 17.83716 18.10748 17.97757
#&gt; 975: 21.98484 18.99760       NA 19.03256       NA       NA 19.61490 16.90435
#&gt;        t2.C12   t2.D14   t2.C15   t2.D16   t2.D17   t2.D18   t2.D19   t3.C01
#&gt;   1: 17.08270 19.58105 21.83444 17.52900 16.62347 19.65894 19.01713 21.74019
#&gt;   2: 16.29131       NA 16.39622 17.91308       NA 16.23028       NA 18.24767
#&gt;   3: 18.21709 17.68598 19.47291 19.27019 17.88636 18.96784       NA 19.29589
#&gt;   4: 27.49874 27.17510 27.54940 28.48148 27.46818 24.14857 28.09233 27.53926
#&gt;   5: 18.43441 18.47666 19.13480 17.40260 17.53581 17.78104 18.35103 19.80792
#&gt;  ---                                                                        
#&gt; 971:       NA 18.59478       NA 19.37595       NA 21.70252 19.82746 21.84825
#&gt; 972: 20.22690 20.92031 21.10686 21.50455 23.09951 21.70233 20.03988 20.75346
#&gt; 973: 14.17211 16.36639 20.59866 15.39228       NA       NA 21.08877       NA
#&gt; 974: 17.20804 18.03524 17.51357       NA 18.37419 15.19549 17.69456 15.96021
#&gt; 975: 17.61326 19.67914 20.65279 18.74067 18.87932 14.52056 17.72085       NA
#&gt;        t3.C02   t3.C03   t3.C04   t3.D05   t3.D06   t3.D08   t3.D09   t3.C10
#&gt;   1: 21.05973 22.82868 25.94998 17.94115 18.44434 20.58086 19.95889 23.90981
#&gt;   2: 17.15416 17.73525 19.80187 19.38610 18.94506 14.42003 19.31410 20.00011
#&gt;   3: 18.50380 18.41441 20.18687 19.60907 18.64713 16.93185       NA 19.89076
#&gt;   4: 28.34502 28.59632 28.13064 27.35923 26.42302 26.31671 27.46896 27.72310
#&gt;   5: 21.03019 21.38214 21.20524 20.06343 19.06510 20.32234 19.44941 21.58690
#&gt;  ---                                                                        
#&gt; 971: 22.37757 23.09788 21.89909 23.92448 22.64285 23.17805 21.12476 21.05945
#&gt; 972: 21.93004 20.99634 20.87786 21.62405 20.83865 22.06644 19.50766 20.79919
#&gt; 973: 17.48208       NA 19.76654 18.71783       NA 18.71274 15.04666 23.07973
#&gt; 974: 18.80851 17.72002 18.86636 18.61881 16.11226 17.65270 17.33866 17.99612
#&gt; 975: 18.49125 20.19293 18.56754       NA 18.60126       NA       NA 18.98737
#&gt;        t3.D11   t3.C12   t3.D14   t3.C15   t3.D16   t3.D17   t3.D18   t3.D19
#&gt;   1: 17.45210 24.73448 25.41654 27.34460 21.09670 20.33629 19.38101 20.90241
#&gt;   2: 16.82083 17.45693 16.23336 22.22094 18.58529 17.45866 14.93051       NA
#&gt;   3: 19.17308 19.03582 19.27706 19.84181 19.32890 18.22573 18.26219 18.21531
#&gt;   4: 27.26239 27.64566 26.75495 28.29047 28.64028 26.63822 24.26315 27.25479
#&gt;   5: 17.40562 21.28211 18.53328 21.08984 21.38079 20.91814 19.30420 21.22863
#&gt;  ---                                                                        
#&gt; 971: 23.35062 22.09711 22.34560 22.81799 22.22947 23.36048 22.33715 20.98335
#&gt; 972: 21.05871 20.94954 21.20288 21.69778 20.92897 21.88019 21.23624 18.86567
#&gt; 973: 18.36337 18.51903 17.01680 20.86064 17.00724 17.21528 18.19028       NA
#&gt; 974:       NA 17.57129 14.85063 17.62434 18.43665 19.22259 17.99298       NA
#&gt; 975: 18.81892 16.83228 20.25302 19.25795 17.38898       NA       NA 17.17819</div><div class='input'>   <span class='fu'>sumexp_to_long_dt</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        feature_id                   feature_name sample_id    value
#&gt;     1:      48762 1,2,3-benzenetriol sulfate (2)    t0.C01 17.41188
#&gt;     2:      34404           1,3,7-trimethylurate    t0.C01       NA
#&gt;     3:      32391              1,3-dimethylurate    t0.C01 17.90141
#&gt;     4:      20675   1,5-anhydroglucitol (1,5-AG)    t0.C01 28.51307
#&gt;     5:      21049             1,6-anhydroglucose    t0.C01 18.23215
#&gt;    ---                                                             
#&gt; 65321:      48992                      X - 23293    t3.D19 20.98335
#&gt; 65322:      48993                      X - 23294    t3.D19 18.86567
#&gt; 65323:      49014                      X - 23314    t3.D19       NA
#&gt; 65324:      49260                      X - 23400    t3.D19       NA
#&gt; 65325:      49562                      X - 23685    t3.D19 17.17819</div><div class='input'>   <span class='fu'>sumexp_to_subrep_dt</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>Group</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       feature_id Group      C01      C02      C03      C04      C10      C12
#&gt;    1:      48762    t0 17.41188 18.89120 23.06114 24.10870 19.46696 16.64318
#&gt;    2:      48762    t1 15.99539 19.37442 22.08304 22.94208 19.64644 17.73968
#&gt;    3:      48762    t2       NA 18.20491 20.90294 21.94360 19.16262 17.08270
#&gt;    4:      48762    t3 21.74019 21.05973 22.82868 25.94998 23.90981 24.73448
#&gt;    5:      34404    t0       NA 20.18044 18.70176 20.37218 19.36820 16.31320
#&gt;   ---                                                                       
#&gt; 3896:      49260    t3 15.96021 18.80851 17.72002 18.86636 17.99612 17.57129
#&gt; 3897:      49562    t0 14.96633 19.30498 23.02848 19.39395 20.13562 18.17484
#&gt; 3898:      49562    t1 15.08879 18.49344 22.66753 19.23717 19.98877 18.28587
#&gt; 3899:      49562    t2       NA 17.94223 21.98484 18.99760 19.61490 17.61326
#&gt; 3900:      49562    t3       NA 18.49125 20.19293 18.56754 18.98737 16.83228
#&gt;            C15      D05      D06      D08      D09      D11      D14      D16
#&gt;    1: 24.30139 19.50892 19.20483 22.55072 20.54472 18.85845 22.48337 19.08502
#&gt;    2: 22.62682 18.31561 18.31305 21.29198 20.53286 17.63573 20.23876 18.25009
#&gt;    3: 21.83444 17.86405 16.24049 20.69028 20.27478 16.95844 19.58105 17.52900
#&gt;    4: 27.34460 17.94115 18.44434 20.58086 19.95889 17.45210 25.41654 21.09670
#&gt;    5: 17.94359 19.18485 19.45492       NA 16.91111 19.20980       NA 18.77779
#&gt;   ---                                                                        
#&gt; 3896: 17.62434 18.61881 16.11226 17.65270 17.33866       NA 14.85063 18.43665
#&gt; 3897: 21.05275       NA 19.26684       NA       NA 17.61116 19.78836 19.72931
#&gt; 3898: 20.98889       NA 19.26985       NA       NA 17.77221 19.75170 19.24164
#&gt; 3899: 20.65279       NA 19.03256       NA       NA 16.90435 19.67914 18.74067
#&gt; 3900: 19.25795       NA 18.60126       NA       NA 18.81892 20.25302 17.38898
#&gt;            D17      D18      D19
#&gt;    1: 18.71060 22.42675 19.79482
#&gt;    2: 17.83637 20.70378 19.34543
#&gt;    3: 16.62347 19.65894 19.01713
#&gt;    4: 20.33629 19.38101 20.90241
#&gt;    5:       NA 17.47769       NA
#&gt;   ---                           
#&gt; 3896: 19.22259 17.99298       NA
#&gt; 3897: 19.09744 17.27134 15.32418
#&gt; 3898: 19.11978 15.90164 17.45970
#&gt; 3899: 18.87932 14.52056 17.72085
#&gt; 3900:       NA       NA 17.17819</div><div class='input'>
<span class='co'># Fukuda</span>
   <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>
   <span class='va'>file</span> <span class='op'>&lt;-</span> <span class='fu'><a href='download_data.html'>download_data</a></span><span class='op'>(</span><span class='st'>'fukuda20.proteingroups.txt'</span><span class='op'>)</span>
   <span class='va'>object</span> <span class='op'>&lt;-</span> <span class='fu'><a href='.read_maxquant.html'>read_proteingroups</a></span><span class='op'>(</span><span class='va'>file</span>, impute<span class='op'>=</span><span class='cn'>FALSE</span>, plot<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>	Read C:\Users\abhagwa\AppData\Local\autonomics\autonomics\Cache/46a4255b2df6_fukuda20.proteingroups.txt</span></div><div class='output co'>#&gt; <span class='message'>		Infer subgroup from sample_ids</span></div><div class='output co'>#&gt; <span class='message'>		Replace 0-&gt;NA for 15654/41112 values (in 3998/6852 features of 6/6 samples)</span></div><div class='output co'>#&gt; <span class='message'>		Log2 transform</span></div><div class='output co'>#&gt; <span class='message'>	Filter features</span></div><div class='output co'>#&gt; <span class='message'>		Retain 6735/6852 features: ~Reverse != "+"</span></div><div class='output co'>#&gt; <span class='message'>		Retain 6692/6735 features: contaminant != '+'</span></div><div class='output co'>#&gt; <span class='message'>		Retain 6679/6692 features: non-zero, non-NA, and non-NaN for some sample</span></div><div class='output co'>#&gt; <span class='message'>		Filter 4534/6679 features: expr &gt; 0 for at least two samples in some subgroup</span></div><div class='output co'>#&gt; <span class='message'>	Transform exprs</span></div><div class='input'>   <span class='fu'>sumexp_to_long_dt</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        feature_id   feature_name sample_id subgroup    value
#&gt;     1:          1       b3galtla  30dpt.R1   X30dpt 31.64470
#&gt;     2:          3           rem1  30dpt.R1   X30dpt       NA
#&gt;     3:          5         sept7a  30dpt.R1   X30dpt 29.64119
#&gt;     4:          6          paics  30dpt.R1   X30dpt 29.64765
#&gt;     5:          7 si:dkey-5n18.1  30dpt.R1   X30dpt 29.63483
#&gt;    ---                                                      
#&gt; 27200:       6845 si:dkey-96g2.1  Adult.R3    Adult 29.27999
#&gt; 27201:       6846     im:7148292  Adult.R3    Adult       NA
#&gt; 27202:       6847     zgc:114181  Adult.R3    Adult 29.75758
#&gt; 27203:       6848          sypl1  Adult.R3    Adult       NA
#&gt; 27204:       6851         tigarb  Adult.R3    Adult 30.23112</div><div class='input'>   <span class='va'>object</span> <span class='op'>%&lt;&gt;%</span> <span class='fu'><a href='impute_systematic_nondetects.html'>impute_systematic_nondetects</a></span><span class='op'>(</span>plot<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>		Impute systematic nondetects for 762/4534 features in 6/6 samples</span></div><div class='input'>   <span class='fu'>sumexp_to_long_dt</span><span class='op'>(</span><span class='va'>object</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        feature_id   feature_name sample_id subgroup       value is_imputed
#&gt;     1:          1       b3galtla  30dpt.R1   X30dpt 31.64469728      FALSE
#&gt;     2:          3           rem1  30dpt.R1   X30dpt  0.01764474       TRUE
#&gt;     3:          5         sept7a  30dpt.R1   X30dpt 29.64118661      FALSE
#&gt;     4:          6          paics  30dpt.R1   X30dpt 29.64765064      FALSE
#&gt;     5:          7 si:dkey-5n18.1  30dpt.R1   X30dpt 29.63483196      FALSE
#&gt;    ---                                                                    
#&gt; 27200:       6845 si:dkey-96g2.1  Adult.R3    Adult 29.27998691      FALSE
#&gt; 27201:       6846     im:7148292  Adult.R3    Adult  0.12019224       TRUE
#&gt; 27202:       6847     zgc:114181  Adult.R3    Adult 29.75757674      FALSE
#&gt; 27203:       6848          sypl1  Adult.R3    Adult  0.57276978       TRUE
#&gt; 27204:       6851         tigarb  Adult.R3    Adult 30.23112005      FALSE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Aditya Bhagwat, Shahina Hayat, Johannes Graumann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


