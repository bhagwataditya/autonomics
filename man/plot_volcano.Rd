% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/7_contrast.R
\name{plot_volcano}
\alias{plot_volcano}
\title{Plot volcano}
\usage{
plot_volcano(
  object,
  contrasts = metadata(object)$contrasts,
  label = feature_name,
  ntop = 3
)
}
\arguments{
\item{object}{SummarizedExperiment}

\item{contrasts}{contrast layout matrix}

\item{label}{fvar for labeling top features}

\item{ntop}{number: n top features to be annotated}

\item{nrow}{number: n rows in faceted plot}
}
\value{
ggplot object
}
\description{
Plot volcano
}
\examples{
# proteingroup group ratios
    file <- download_data("billing16.proteingroups.txt")
    inv <- c('EM_E', 'BM_E', 'BM_EM')
    object <- read_proteingroups(file, invert_subgroups=inv, plot=FALSE)
    plot_volcano(object)
    contrasts <- layout_contrasts(subgroup_levels(object))
    object \%<>\% add_limma(contrasts = contrasts, plot = FALSE)
    plot_volcano(object)

# proteingroup LFQ intensities
    file <- download_data('fukuda20.proteingroups.txt')
    object <- read_proteingroups(file, plot=FALSE)
    plot_volcano(object)

# metabolon intensities: complex design
    file <- download_data('halama18.metabolon.xlsx')
    object <- read_metabolon(file, plot=FALSE)
    plot_volcano(object)
    colcontrasts <- names(col_contrasts(object))
    rowcontrasts <- names(row_contrasts(object))
    plot_volcano(object, contrastnames=colcontrasts, nrow=4, ntop=1)
    plot_volcano(object, contrastnames=rowcontrasts, nrow=3, ntop=1)

# proteingroup internalstandard ratios
    file <-  download_data('billing19.proteingroups.txt')
    rm_subgroups <-  c('BLANK_BM00', 'BLANK_STD', 'BM00_BM00', 'EM01_EM00',
                       'EM05_EM02', 'EM30_EM15')
    object <- read_proteingroups(file, rm_subgroups=rm_subgroups, plot=FALSE)
    require(magrittr)
    object$subgroup \%<>\% gsub('_STD', '', .)
    subgroups <- c('EM00','EM01','EM02','EM05','EM15','EM30','BM00')
    object$subgroup \%<>\% factor(subgroups)
    contrasts <- c(col_contrasts(object), row_contrasts(object))
    object \%<>\% add_limma(contrasts = contrasts)
    plot_volcano(object)
}
