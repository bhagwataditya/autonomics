% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/8_fit_lmx.R
\name{extract_full_block_features}
\alias{extract_full_block_features}
\title{Extract full block features}
\usage{
extract_full_block_features(object, formula, block, n = 2, verbose = TRUE)
}
\arguments{
\item{object}{SummarizedExperiment}

\item{formula}{formula}

\item{block}{factorvector (numeric object) or svar (sumexp object)}

\item{n}{number of full factor blocks}

\item{verbose}{TRUE or FALSE}
}
\description{
Extract features with two blocks (or more) spanning all within-factor levels
}
\examples{
# Read
    file <- download_data('atkin18.metabolon.xlsx')
    object <- read_metabolon(file)
    cols <- c('sample_id', 'subgroup', 'SUB', 'SET', 'AGE', 'SEX', 'T2D')
    sdt(object) \%<>\% extract(, cols, with = FALSE)
    sdt(object)
    object$SUPERSET <- ''
    object$SUPERSET[object$SET == 't0'] <- 'I'
    object$SUPERSET[object$SET == 't1'] <- 'I'
    object$SUPERSET[object$SET == 't2'] <- 'II'
    object$SUPERSET[object$SET == 't3'] <- 'II'
    object$SUBSET <- ''
    object$SUBSET[  object$SET == 't0'] <- 'a'
    object$SUBSET[  object$SET == 't1'] <- 'a'
    object$SUBSET[  object$SET == 't2'] <- 'b'
    object$SUBSET[  object$SET == 't3'] <- 'b'
# Extract
    extract_full_block_features(object, formula = ~ SET,                     block = 'SUB')
    extract_full_block_features(object, formula = ~ SUPERSET + SUBSET,       block = 'SUB')
    extract_full_block_features(object, formula = ~ SUPERSET + SUBSET,       block = 'SUB')
    extract_full_block_features(object, formula = ~ SUPERSET + SUBSET,       block = c('SUB', 'SEX'))
    extract_full_block_features(object, formula = ~ SUPERSET + SUBSET + AGE, block = c('SUB', 'SEX'))
    extract_full_block_features(object, formula = ~ SUPERSET + SUBSET + T2D, block = c('SUB', 'SEX'))
}
