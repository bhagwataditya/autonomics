% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/7_contrast.R
\name{add_limma}
\alias{add_limma}
\title{Contrast}
\usage{
add_limma(
  object,
  contrastdefs = contrast_subgroups(object),
  formula = if (single_subgroup(object)) ~1 else ~0 + subgroup,
  plot = TRUE,
  ...
)
}
\arguments{
\item{object}{SummarizedExperiment}

\item{contrastdefs}{contrastdef vector / matrix / list:
\itemize{
\item{c("t1-t0", "t2-t1", "t3-t2")}
\item{matrix(c("WT.t1-WT.t0", "WT.t2-WT.t1", "WT.t3-WT.t2"), \cr
     c("KD.t1-KD.t0", "KD.t2-KD.t1", "KD.t3-KD.t2"), nrow=2, byrow=TRUE)}
\item{list(matrix(c("WT.t1-WT.t0", "WT.t2-WT.t1", "WT.t3-WT.t2"), \cr
     c("KD.t1-KD.t0", "KD.t2-KD.t1", "KD.t3-KD.t2"), nrow=2, byrow=TRUE), \cr
     matrix(c("KD.t0-WT.t0", "KD.t1-WT.t1", "KD.t2-WT.t2", "KD.t3-WT.t3"),\cr
     nrow=1, byrow=TRUE))}}}

\item{formula}{formula to create design matrix (using svars)}

\item{plot}{TRUE/FALSE}

\item{...}{passed to plot_contrastogram}
}
\value{
Updated SummarizedExperiment
}
\description{
Fit linear model and analyze contrasts
}
\details{
Limma results can be easily accessed with limma(object).
This returns a list with components:
\itemize{
   \item {effect} matrix (ngene x ncontrast): effect sizes
   \item {rank}   matrix (ngene x ncontrast): effect ranks
   \item {t}      matrix (ngene x ncontrast): t    values (moderated t test)
   \item {se}     matrix (ngene x ncontrast): se   values (moderated t test)
   \item {p}      matrix (ngene x ncontrast): p    values (moderated t test)
   \item {fdr}    matrix (ngene x ncontrast): fdr  values (moderated t test)
   \item {bonf}   matrix (ngene x ncontrast): bonf values (moderated t test)
   \item {F}      vector (ngene)            : F    values (moderated F test)
   \item {F.p}    vector (ngene)            : p    values (moderated F test)
}
}
\examples{
require(magrittr)
file <- download_data('atkin18.somascan.adat')
object <- read_somascan(file, plot=FALSE)
add_limma(object)

file <- download_data('billing19.proteingroups.txt')
select_subgroups <-  c(sprintf(
    '\%s_STD', c('EM00','EM01', 'EM02','EM05','EM15','EM30', 'BM00')))
object <- read_proteingroups(
            file, select_subgroups = select_subgroups, plot = FALSE)
object$subgroup \%<>\% gsub('_STD', '', .)
object$subgroup \%<>\% factor(sort(unique(.))[c(2:length(.), 1)])
object \%<>\% add_limma()

file <- download_data('billing19.rnacounts.txt')
object <- read_counts(file, plot=FALSE)
object$subgroup \%<>\% factor(sort(unique(.))[c(2:length(.), 1)])
object \%<>\% add_limma()

file <- download_data('halama18.metabolon.xlsx')
object <- read_metabolon(file, plot = FALSE)
object \%<>\% add_limma()
}
