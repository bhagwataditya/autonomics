% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/contrast.R
\name{add_limma}
\alias{add_limma}
\title{Add limma}
\usage{
add_limma(
  object,
  contrastdefs = default_contrasts(object),
  design = create_design(object)
)
}
\arguments{
\item{object}{SummarizedExperiment}

\item{contrastdefs}{contrastdef vector, preferably named
(automatically generated names are not always intuitive)}

\item{design}{design matrix}
}
\value{
Updated SummarizedExperiment
}
\description{
Run limma and add results
}
\details{
Limma results can be easily accessed with limma(object).
This returns a list with components:
\itemize{
   \item {effect} matrix (ngene x ncontrast): effect sizes
   \item {rank}   matrix (ngene x ncontrast): effect ranks
   \item {t}      matrix (ngene x ncontrast): t    values (moderated t test)
   \item {se}     matrix (ngene x ncontrast): se   values (moderated t test)
   \item {p}      matrix (ngene x ncontrast): p    values (moderated t test)
   \item {fdr}    matrix (ngene x ncontrast): fdr  values (moderated t test)
   \item {bonf}   matrix (ngene x ncontrast): bonf values (moderated t test)
   \item {F}      vector (ngene)            : F    values (moderated F test)
   \item {F.p}    vector (ngene)            : p    values (moderated F test)
}
}
\examples{
require(magrittr)
file <- download_data('atkin18.somascan.adat')
object <- read_somascan(file)
add_limma(object)

file <- download_data('billing19.proteingroups.txt')
rm_subgroups<-c('BLANK_BM00','BM00_BM00','EM01_EM00','EM05_EM02','EM30_EM15')
object <- read_proteingroups(file, rm_subgroups = rm_subgroups)
contrastdefs <- c(EM01_EM00 = 'EM01_STD - EM00_STD')
object \%<>\% add_limma(contrastdefs)
sum(limma(object)[,'EM01_EM00','bonf'] < 0.05, na.rm = TRUE)

file <- download_data('billing19.rnacounts.txt')
object <- read_counts(file)
contrastdefs <- c(EM01_EM00 = 'EM01 - EM00')
object \%<>\% add_limma(contrastdefs)
sum(limma(object)[,'EM01_EM00','bonf'] < 0.05, na.rm = TRUE)
}
