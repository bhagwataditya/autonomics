% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2_read_proteingroups.R
\name{read_proteingroups}
\alias{read_proteingroups}
\alias{read_phosphosites}
\title{Read proteingroups/phosphosites}
\usage{
read_proteingroups(
  proteinfile,
  quantity = guess_maxquant_quantity(proteinfile),
  colfile = default_colfile(proteinfile, "maxquant", quantity),
  select_subgroups = NULL,
  contaminants = FALSE,
  reverse = FALSE,
  fastafile = NULL,
  invert_subgroups = character(0),
  impute = stri_detect_regex(quantity, "[Ii]ntensity"),
  formula = if (single_subgroup(object)) ~1 else ~0 + subgroup,
  contrastdefs = contrast_subgroups(object),
  verbose = TRUE,
  plot = TRUE
)

read_phosphosites(
  phosphofile,
  proteinfile = paste0(dirname(phosphofile), "/proteinGroups.txt"),
  quantity = guess_maxquant_quantity(phosphofile),
  colfile = default_colfile(proteinfile, "maxquant", quantity),
  select_subgroups = NULL,
  contaminants = FALSE,
  reverse = FALSE,
  min_localization_prob = 0.75,
  fastafile = NULL,
  invert_subgroups = character(0),
  formula = if (single_subgroup(object)) ~1 else ~0 + subgroup,
  contrastdefs = contrast_subgroups(object),
  verbose = TRUE,
  plot = TRUE
)
}
\arguments{
\item{proteinfile}{proteingroups file path}

\item{quantity}{string: "Ratio normalized",
"Ratio",
"LFQ intensity",
"Reporter intensity corrected",
"Reporter intensity",
"Intensity labeled",
"Intensity"}

\item{colfile}{colfile path}

\item{select_subgroups}{subgroups to be selected (character vector)}

\item{contaminants}{whether to return contaminants (TRUE/FALSE)}

\item{reverse}{whether to return reverse peptides (TRUE/FALSE)}

\item{fastafile}{NULL or fastafile (to deconvolute proteingroups)}

\item{invert_subgroups}{subgroups to be inverted (character vector)}

\item{impute}{whether to impute consistent nondetects (TRUE/FALSE)}

\item{formula}{formula to create design matrix (using svars)}

\item{contrastdefs}{contrast definition vector/matrix/list}

\item{verbose}{TRUE/FALSE}

\item{plot}{TRUE/FALSE}

\item{phosphofile}{phosphosites  file path}

\item{min_localization_prob}{min site localization probability (number)}
}
\value{
SummarizedExperiment
}
\description{
Read proteingroups/phosphosites
}
\examples{
# LFQ intensities
    file <- download_data('fukuda20.proteingroups.txt')
    object <- read_proteingroups(file)

# Ratios: invert if required
    file <- download_data('billing16.proteingroups.txt')
    inv <- c('EM_E','BM_E','BM_EM')
    object <- read_proteingroups(file, invert_subgroups = inv,
                                 contrastdefs = c('E_EM', 'E_BM', 'EM_BM'))

# Unnormalized Intensities: specify quantity
    object <- read_proteingroups(file, quantity = 'Intensity labeled')

# Internal Standard Ratios: rm meaningless ratios
    file <-  download_data('billing19.proteingroups.txt')
    select_subgroups <-  c(sprintf(
        '\%s_STD', c('EM00','EM01', 'EM02','EM05','EM15','EM30', 'BM00')))
    object <- read_proteingroups(file, select_subgroups = select_subgroups)

# Phosphosites
    phosphofile <- download_data('billing19.phosphosites.txt')
    proteinfile <- download_data('billing19.proteingroups.txt')
    read_phosphosites(phosphofile, proteinfile,
                        select_subgroups = select_subgroups)

# Deconvolute proteingroups
    fdata(object)[1:3, 1:4]
    object <- read_proteingroups(file,quantity = 'Intensity labeled',
        fastafile=download_data('uniprot_hsa_20140515.fasta'), plot=FALSE)
    fdata(object)[1:3, 1:4]
}
