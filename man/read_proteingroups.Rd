% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2_read_proteingroups.R
\name{.read_maxquant}
\alias{.read_maxquant}
\alias{read_proteingroups}
\alias{read_phosphosites}
\title{Read proteingroups/phosphosites}
\usage{
.read_maxquant(
  file,
  quantity = guess_maxquant_quantity(file),
  samplefile = NULL,
  sampleidvar = "sample_id",
  subgroupvar = "subgroup",
  select_subgroups = NULL,
  invert_subgroups = character(0),
  verbose = TRUE
)

read_proteingroups(
  file,
  quantity = guess_maxquant_quantity(file),
  samplefile = NULL,
  select_subgroups = NULL,
  contaminants = FALSE,
  reverse = FALSE,
  fastafile = NULL,
  invert_subgroups = character(0),
  impute = stri_detect_regex(quantity, "[Ii]ntensity"),
  formula = NULL,
  block = NULL,
  contrastdefs = NULL,
  pca = TRUE,
  lmfit = TRUE,
  verbose = TRUE,
  plot = TRUE
)

read_phosphosites(
  file,
  proteinfile = paste0(dirname(file), "/proteinGroups.txt"),
  quantity = guess_maxquant_quantity(file),
  samplefile = NULL,
  select_subgroups = NULL,
  contaminants = FALSE,
  reverse = FALSE,
  min_localization_prob = 0.75,
  fastafile = NULL,
  invert_subgroups = character(0),
  pca = TRUE,
  lmfit = TRUE,
  formula = NULL,
  contrastdefs = NULL,
  verbose = TRUE,
  plot = TRUE
)
}
\arguments{
\item{file}{proteingroups/phosphosites file}

\item{quantity}{string: "Ratio normalized",
"Ratio",
"LFQ intensity",
"Reporter intensity corrected",
"Reporter intensity",
"Intensity labeled",
"Intensity"}

\item{samplefile}{samplefile path}

\item{sampleidvar}{sampleid svar}

\item{subgroupvar}{subgroup svar}

\item{select_subgroups}{subgroups to be selected (character vector)}

\item{invert_subgroups}{subgroups to be inverted (character vector)}

\item{verbose}{whether to message}

\item{contaminants}{whether to return contaminants}

\item{reverse}{whether to return reverse peptides}

\item{fastafile}{NULL or fastafile (to deconvolute proteingroups)}

\item{impute}{whether to impute consistent nondetects}

\item{formula}{desgnmat formula}

\item{block}{block svar}

\item{contrastdefs}{contrastdef vector/matrix/list}

\item{pca}{whether to pca}

\item{lmfit}{whether to lmfit/contrast}

\item{plot}{whether to plot}

\item{proteinfile}{proteingroups file}

\item{min_localization_prob}{min site localization probability (number)}
}
\value{
SummarizedExperiment
}
\description{
Read proteingroups/phosphosites
}
\examples{
# LFQ intensities
    file <- download_data('fukuda20.proteingroups.txt')
    object <- .read_maxquant(file)      # Read
    object <-  read_proteingroups(file) # Read / Analyze

# Ratios: invert if required
    file <- download_data('billing16.proteingroups.txt')
    inv <- c('EM_E','BM_E','BM_EM')
    object <- read_proteingroups(file, invert_subgroups = inv,
                                 contrastdefs = c('E_EM', 'E_BM', 'EM_BM'))

# Unnormalized Intensities: specify quantity
    object <- read_proteingroups(file, quantity = 'Intensity labeled')

# Internal Standard Ratios: rm meaningless ratios
    require(magrittr)
    file <-  download_data('billing19.proteingroups.txt')
    select_subgroups <-  c('E00','E01', 'E02','E05','E15','E30', 'M00')
    select_subgroups \%<>\% paste0('_STD')
    object <- read_proteingroups(file, select_subgroups = select_subgroups)

# Phosphosites
    phosphofile <- download_data('billing19.phosphosites.txt')
    proteinfile <- download_data('billing19.proteingroups.txt')
    read_phosphosites(phosphofile, proteinfile,
                        select_subgroups = select_subgroups)

# Deconvolute proteingroups
    file <-  download_data('billing16.proteingroups.txt')
    object <- read_proteingroups(file,quantity = 'Intensity labeled',
        fastafile=download_data('uniprot_hsa_20140515.fasta'), plot=FALSE)
    fdata(object)[1:3, 1:4]
    object <- read_proteingroups(file,quantity = 'Intensity labeled',
        fastafile=download_data('uniprot_hsa_20140515.fasta'), plot=FALSE)
    fdata(object)[1:3, 1:4]
}
