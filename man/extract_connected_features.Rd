% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/8_fit_lmx.R
\name{extract_connected_features}
\alias{extract_connected_features}
\title{Extract connected features}
\usage{
extract_connected_features(
  object,
  formula,
  blockvars,
  nconnectedblocks = 2,
  verbose = TRUE
)
}
\arguments{
\item{object}{SummarizedExperiment}

\item{formula}{formula}

\item{blockvars}{factorvector (numeric object) or svar (sumexp object)}

\item{nconnectedblocks}{minimum number of connected blocks}

\item{verbose}{TRUE or FALSE}
}
\description{
Extract features for which connected factor levels are measured in at least two blocks
}
\examples{
# Read
    file <- download_data('atkin.metabolon.xlsx')
    object <- read_metabolon(file)
    cols <- c('sample_id', 'subgroup', 'Subject', 'Time', 'Age', 'Sex', 'Diabetes')
    sdt(object) \%<>\% extract(, cols, with = FALSE)
    sdt(object)
    object$SUPERSET <- ''
    object$SUPERSET[object$Time == 't0'] <- 'I'
    object$SUPERSET[object$Time == 't1'] <- 'I'
    object$SUPERSET[object$Time == 't2'] <- 'II'
    object$SUPERSET[object$Time == 't3'] <- 'II'
    object$SUBSET <- ''
    object$SUBSET[  object$Time == 't0'] <- 'a'
    object$SUBSET[  object$Time == 't1'] <- 'a'
    object$SUBSET[  object$Time == 't2'] <- 'b'
    object$SUBSET[  object$Time == 't3'] <- 'b'
# Extract
    extract_connected_features(object, formula = ~ Time,                         blockvars =   'Subject')
    extract_connected_features(object, formula = ~ SUPERSET + SUBSET,            blockvars =   'Subject')
    extract_connected_features(object, formula = ~ SUPERSET + SUBSET,            blockvars = c('Subject', 'Sex'))
    extract_connected_features(object, formula = ~ SUPERSET + SUBSET + Age,      blockvars = c('Subject', 'Sex'))
    extract_connected_features(object, formula = ~ SUPERSET + SUBSET + Diabetes, blockvars = c('Subject', 'Sex'))
}
