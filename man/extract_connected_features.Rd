% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/8_fit_lmx.R
\name{extract_connected_features}
\alias{extract_connected_features}
\title{Extract connected features}
\usage{
extract_connected_features(
  object,
  formula,
  blockvars,
  nconnectedblocks = 2,
  verbose = TRUE
)
}
\arguments{
\item{object}{SummarizedExperiment}

\item{formula}{formula}

\item{blockvars}{factorvector (numeric object) or svar (sumexp object)}

\item{nconnectedblocks}{minimum number of connected blocks}

\item{verbose}{TRUE or FALSE}
}
\description{
Extract features for which connected factor levels are measured in at least two blocks
}
\examples{
# Read
    file <- download_data('atkin18.metabolon.xlsx')
    object <- read_metabolon(file)
    cols <- c('sample_id', 'subgroup', 'SUB', 'SET', 'AGE', 'SEX', 'T2D')
    sdt(object) \%<>\% extract(, cols, with = FALSE)
    sdt(object)
    object$SUPERSET <- ''
    object$SUPERSET[object$SET == 't0'] <- 'I'
    object$SUPERSET[object$SET == 't1'] <- 'I'
    object$SUPERSET[object$SET == 't2'] <- 'II'
    object$SUPERSET[object$SET == 't3'] <- 'II'
    object$SUBSET <- ''
    object$SUBSET[  object$SET == 't0'] <- 'a'
    object$SUBSET[  object$SET == 't1'] <- 'a'
    object$SUBSET[  object$SET == 't2'] <- 'b'
    object$SUBSET[  object$SET == 't3'] <- 'b'
# Extract
    extract_connected_features(object, formula = ~ SET, 
                                     blockvars = 'SUB')

    extract_connected_features(object, formula = ~ SUPERSET + SUBSET,
                                     blockvars = 'SUB')

    extract_connected_features(object, formula = ~ SUPERSET + SUBSET,
                                     blockvars = c('SUB', 'SEX'))

    extract_connected_features(object, formula = ~ SUPERSET + SUBSET + AGE, 
                                     blockvars = c('SUB', 'SEX'))

    extract_connected_features(object, formula = ~ SUPERSET + SUBSET + T2D, 
                                     blockvars = c('SUB', 'SEX'))
}
