% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/8_fit_limma.R
\name{code}
\alias{code}
\alias{code.factor}
\alias{code.data.table}
\alias{code_reference}
\alias{code_grandref}
\alias{code_difference}
\alias{code_granddiff}
\alias{code_sum}
\alias{code_helmert}
\title{Contrast Code Factor}
\usage{
code(object, ...)

\method{code}{factor}(object, coding, verbose = TRUE, ...)

\method{code}{data.table}(object, coding, vars = names(object), verbose = TRUE, ...)

code_reference(n)

code_grandref(n)

code_difference(n)

code_granddiff(n)

code_sum(n)

code_helmert(n)
}
\arguments{
\item{coding}{coding system \cr
'treatment'  :  coef = level - firstlevel, intercept = firstlevel, implicit coefnames (t2).   \cr
'reference'  :  coef = level - firstlevel, intercept = firstlevel, explicit coefnames (t2-t0) \cr
'difference' :  coef = level -  prevlevel, intercept = firstlevel, epxlicit coefnames (t2-t1) \cr
'grandref'   :  coef = level - firstlevel, intercept = grandmean   \cr
'granddiff'  :  coef = level -  prevlevel, intercept = grandmean   \cr
'sum'        :  coef = level -  grandmean, intercept = grandmean   \cr
'helmert'    :  coef = level - prevlevels, intercept = grandmean   \cr}

\item{verbose}{TRUE or FALSE}

\item{n}{factor levels (character) vector}

\item{x}{factor vector}
}
\value{
(explicitly coded) factor vector
}
\description{
Contrast Code Factor for General Linear Model
}
\details{
A General Linear Model contains:                                                                   \cr
  * An Intercept Coefficient: expressing some form of sample average                               \cr
  * For each numeric variable: a slope coefficient                                                 \cr
  * For each k-leveled factor: (k-1) Contrast Coefficients.                                        \cr
       The interpretation of (intercept and contrast) coefficients depends on the contrast coding function used.
       Several contrast coding functions are available in 'stats' and 'codingMatrices'
       But their (function and coefficient) namings are a bit confusing and unsystematic.
       Instead, the functions below offer an intuitive interface (to the otherwise powerful stats/codingMatrices packages).
       The names of these functions reflect the contrast coding used (treatment, difference, sum, or helmert contrasts).
       They also reflect the intercept interpretation (either first factor's first level or grand mean).
       They all produce intuitive coefficient names (e.g. 't1-t0' rather than just 't1').
       They all have unit scaling (a coefficient of 1 means a difference of 1).
}
\examples{
# Coding functions
    x <- factor(paste0('t', 0:3))
    code_reference( levels(x))
    code_grandref(  levels(x))
    code_difference(levels(x))
    code_granddiff( levels(x))
    code_sum(       levels(x))
    code_helmert(   levels(x))

# Code
    x \%<>\% code('treatment')
    x \%<>\% code('reference')
    x \%<>\% code('grandref')
    x \%<>\% code('difference')
    x \%<>\% code('granddiff')
    x \%<>\% code('sum')
    x \%<>\% code('helmert')

# Model
    file <- download_data('atkin18.metabolon.xlsx')
    object <- read_metabolon(file)
    object \%<>\% fit_limma(coding = 'treatment') # default
    object \%<>\% fit_limma(coding = 'reference')
    object \%<>\% fit_limma(coding = 'grandref')
    object \%<>\% fit_limma(coding = 'difference')
    object \%<>\% fit_limma(coding = 'granddiff')
    object \%<>\% fit_limma(coding = 'sum')
    object \%<>\% fit_limma(coding = 'helmert')
}
