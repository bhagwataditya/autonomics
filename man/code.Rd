% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/8_fit_limma.R
\name{code}
\alias{code}
\title{Code factor}
\usage{
code(x, contr.fun = contr.treatment, verbose = TRUE)
}
\arguments{
\item{x}{factor/character vector}

\item{contr.fun}{contrast coding function: contr.treatment, contr.sum, contr.helmert}

\item{verbose}{TRUE or FALSE}
}
\value{
(explicitly coded) factor vector
}
\description{
Code factor for use in General Linear Model
}
\details{
In a General Linear Model, each k-leveled factor is coded with k-1 coefficients.
Each of these coefficients represents a contrast (a difference).
Which contrasts are represented depends on the contrast coding function used.
This is demonstrated in the examples.
}
\examples{
# Contrast to referencelevel
    require(codingMatrices)       # codingMatrices::code_xxx  vs  stats::contr.xxx
    x <- paste0('time', 0:3)
    x \%<>\% code(contr.treatment)  # Intercept = reflevel
    x \%<>\% code(code_control)     #             globalmean

# Contrast to precedinglevel
    x \%<>\% code(contr.diff)       # Intercept = reflevel
    x \%<>\% code(code_diff)        #             globalmean

# Contrast to globalmean
    x \%<>\% code(contr.sum)        # Intercept = globalmean. Functions identical.
    x \%<>\% code(code_deviation)

# Contrast to precedingmean       # Intercept = globalmean.
    x \%<>\% code(code_helmert)     #  code_helmert is  properly scaled: coef = 1 means diff = 1
    x \%<>\% code(contr.helmert)    # contr.helmert not properly scaled: coef = 1 means diff = a*1

# SummarizedExperiment context
    file <- download_data('atkin18.metabolon.xlsx')
    object <- read_metabolon(file)
    object \%<>\% fit_limma()
}
