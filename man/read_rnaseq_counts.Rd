% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2_read_rnaseq.R
\name{.read_rnaseq_counts}
\alias{.read_rnaseq_counts}
\alias{read_rnaseq_counts}
\title{Read RNAseq counts}
\usage{
.read_rnaseq_counts(
  file,
  fid_col = 1,
  samplefile = NULL,
  sampleidvar = NULL,
  subgroupvar = NULL,
  featurefile = NULL,
  featureidvar = NULL,
  featurenamevar = NULL,
  verbose = TRUE
)

read_rnaseq_counts(
  file,
  fid_col = 1,
  samplefile = NULL,
  sampleidvar = NULL,
  subgroupvar = NULL,
  block = NULL,
  featurefile = NULL,
  featureidvar = NULL,
  featurenamevar = NULL,
  formula = if (is.null(subgroupvar)) ~1 else ~0 + subgroup,
  contrastdefs = contrast_subgroups(object),
  min_count = 10,
  pseudocount = 0.5,
  genesize = NULL,
  cpm = TRUE,
  voom = TRUE,
  log2 = TRUE,
  pca = TRUE,
  limma = TRUE,
  verbose = TRUE,
  plot = TRUE
)
}
\arguments{
\item{file}{string: path to rnaseq counts file}

\item{fid_col}{number of name of column with feature identifiers}

\item{samplefile}{sample file}

\item{sampleidvar}{sampleid var}

\item{subgroupvar}{subgroup var}

\item{verbose}{TRUE/FALSE}

\item{formula}{formula to create design matrix (using svars)}

\item{contrastdefs}{contrastdef vector/matrix/list}

\item{min_count}{number (default 10): filter out features}

\item{pseudocount}{number}

\item{genesize}{NULL or fvar}

\item{cpm}{TRUE/FALSE: compute counts per million (scaled) reads?}

\item{voom}{TRUE/FALSE: compute voom precision weights?}

\item{log2}{TRUE/FALSE}

\item{pca}{TRUE/FALSE  run pca?}

\item{limma}{TRUE/FALSE: run contrast analysis?}

\item{plot}{TRUE/FALSE}

\item{fname_col}{string or number: feature name variable}
}
\value{
SummarizedExperiment
}
\description{
Read tsv file with rnaseq counts into SummarizedExperiment
}
\examples{
# BILLING19
    # ~ 0 + subgroup
    file <- download_data('billing19.rnacounts.txt')
    object <- read_rnaseq_counts(file)
    extract_limma_summary(object)

    # ~ 0 + subgroups | weights
    weights(object) <- NULL
    object \%<>\% add_limma(plot=FALSE)
    extract_limma_summary(object)

# GSE161731
   # Download
   require(magrittr)
   require(GEOquery)
   basedir <- '~/autonomicscache/datasets'
   subdir  <- '~/autonomicscache/datasets/GSE161731'
   if (!dir.exists(subdir))  getGEOSuppFiles("GSE161731",baseDir = basedir)
   file       <- paste0(subdir,'/GSE161731_counts.csv.gz')
   samplefile <- paste0(subdir,'/GSE161731_counts_key.csv.gz')

   # Read
   .read_rnaseq_counts(file)
   .read_rnaseq_counts(file, samplefile = samplefile, sampleidvar = 'rna_id')
   .read_rnaseq_counts(file, samplefile = samplefile, sampleidvar = 'rna_id',
                        subgroupvar = 'cohort')

   # Read and analyze
   read_rnaseq_counts(file, samplefile = samplefile, sampleidvar = 'rna_id')
   read_rnaseq_counts(file, samplefile = samplefile, sampleidvar = 'rna_id',
                       subgroupvar = 'cohort')

   # Read and analyze with block effect
   object <- .read_rnaseq_counts(file, samplefile = samplefile,
                         sampleidvar = 'rna_id', subgroupvar = 'cohort')
   object \%<>\% filter_samples(
         subject_id \%in\% names(which(table(subject_id)>1)), verbose=TRUE)
   object \%<>\% pca(plot=TRUE)
   object \%<>\% filter_samples(subgroup != 'healthy')
   object \%<>\% pca(plot=TRUE)
   tail(fnames(object)) == tail(fdata(object)$feature_id)  # NEEDS FIX!
   preprocess_rnaseq_counts(object, subgroupvar = 'cohort', block = 'subject_id')

   read_rnaseq_counts(file, samplefile = samplefile, sampleidvar = 'rna_id', subgroupvar = 'cohort', block = 'subject_id')
   read_rnaseq_counts(file, samplefile = samplefile, sampleidvar = 'rna_id', subgroupvar = 'gender')
}
