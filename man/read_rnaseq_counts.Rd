% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/3.1_read_rnaseq.R
\name{.read_rnaseq_bams}
\alias{.read_rnaseq_bams}
\alias{.read_rnaseq_counts}
\alias{read_rnaseq_bams}
\alias{read_rnaseq_counts}
\title{Read rnaseq}
\usage{
.read_rnaseq_bams(
  dir,
  paired,
  genome,
  nthreads = detectCores(),
  sfile = NULL,
  by.y = NULL,
  subgroupvar = "subgroup",
  ensdb = NULL,
  verbose = TRUE
)

.read_rnaseq_counts(
  file,
  fid_col = 1,
  sfile = NULL,
  by.y = NULL,
  subgroupvar = "subgroup",
  ensdb = NULL,
  verbose = TRUE
)

read_rnaseq_bams(
  dir,
  paired,
  genome,
  nthreads = detectCores(),
  sfile = NULL,
  by.y = NULL,
  subgroupvar = "subgroup",
  block = NULL,
  formula = NULL,
  min_count = 10,
  pseudo = 0.5,
  ensdb = NULL,
  tpm = FALSE,
  cpm = TRUE,
  log2 = TRUE,
  pca = TRUE,
  fit = "limma",
  voom = cpm,
  contrastdefs = NULL,
  verbose = TRUE,
  plot = pca & !is.null(fit),
  feature_id = NULL,
  sample_id = NULL
)

read_rnaseq_counts(
  file,
  fid_col = 1,
  sfile = NULL,
  by.y = NULL,
  subgroupvar = "subgroup",
  block = NULL,
  formula = NULL,
  min_count = 10,
  pseudo = 0.5,
  tpm = FALSE,
  ensdb = NULL,
  cpm = !tpm,
  log2 = TRUE,
  pca = TRUE,
  fit = "limma",
  voom = cpm,
  coefs = NULL,
  contrastdefs = NULL,
  verbose = TRUE,
  plot = pca & !is.null(fit),
  feature_id = NULL,
  sample_id = NULL,
  palette = NULL
)
}
\arguments{
\item{dir}{read_rnaseq_bams: bam/samfile dir}

\item{paired}{read_rnaseq_bams: whether paired end reads}

\item{genome}{read_rnaseq_bams: mm10"/"hg38"/etc. or GTF file}

\item{nthreads}{read_rnaseq_bams: nthreads used by Rsubread::featureCounts()}

\item{sfile}{sample file}

\item{by.y}{sample file mergeby column}

\item{subgroupvar}{subgroup svar}

\item{ensdb}{EnsDb e.g. AnnotationHub::AnnotationHub[['AH64923']]}

\item{verbose}{whether to message}

\item{file}{read_rnaseq_counts: count file}

\item{fid_col}{featureid fvar}

\item{block}{block svar}

\item{formula}{designmat formula}

\item{min_count}{min feature count required in some samples}

\item{pseudo}{added pseudocount to prevent -Inf log2 values}

\item{cpm}{whether to compute cpm}

\item{log2}{whether to log2 transform}

\item{pca}{whether to pca}

\item{fit}{fit model: NULL, 'limma', 'lm', 'lme', 'lmer', 'wilcoxon'}

\item{voom}{whether to compute voom precision weights}

\item{contrastdefs}{NULL or character vector: coefficient contrasts to test}

\item{plot}{whether to plot}

\item{feature_id}{string: which feature to visualize}

\item{sample_id}{string: which sample to visualize}

\item{coefs}{NULL or character vector: model coefficients to test}
}
\value{
SummarizedExperiment
}
\description{
Read/analyze rnaseq counts / bamfiles
}
\examples{
# bams
    if (requireNamespace('Rsubread')){
        dir <- download_data('billing16.bam.zip')
        object <- read_rnaseq_bams(
           dir, paired = TRUE, genome = 'hg38', pca = TRUE, 
           fit = 'limma', plot = TRUE)
    }
# counts
    rnafile <- download_data('billing19.rnacounts.txt')
    fid <- 'CAV2'
    rna <- read_rnaseq_counts(rnafile, fid_col = 'gene_name', sample_id = 'E05_R1', feature_id = fid, coefs = 'subgroupE05')
    rna <- read_rnaseq_counts(rnafile, fid_col = 'gene_name', sample_id = 'E05_R1', feature_id = fid, coefs = 'subgroupE05', voom = F)
    rna <- read_rnaseq_counts(rnafile, fid_col = 'gene_name', sample_id = 'E05_R1', feature_id = fid, coefs = 'subgroupE05', voom = F, cpm = F)
    rna <- read_rnaseq_counts(rnafile, fid_col = 'gene_name', sample_id = 'E05_R1', feature_id = fid, coefs = 'subgroupE05', voom = F, cpm = F, log2 = F) 
\dontrun{
    ah <- AnnotationHub::AnnotationHub()
    ensdb <- ah[['AH64923']]
    object <- read_rnaseq_counts(file, feature_id = fid, coefs = 'subgroupE02', tpm = TRUE, ensdb = ensdb)
 }
}
\author{
Aditya Bhagwat, Shahina Hayat
}
