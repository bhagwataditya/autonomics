% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/2_read_rnaseq.R
\name{.read_rnaseq_counts}
\alias{.read_rnaseq_counts}
\alias{read_rnaseq_counts}
\title{Read rnaseq counts}
\usage{
.read_rnaseq_counts(
  file,
  fid_col = 1,
  samplefile = NULL,
  sampleidvar = NULL,
  subgroupvar = NULL,
  featurefile = NULL,
  featureidvar = NULL,
  featurenamevar = NULL,
  verbose = TRUE
)

read_rnaseq_counts(
  file,
  fid_col = 1,
  samplefile = NULL,
  sampleidvar = NULL,
  subgroupvar = NULL,
  block = NULL,
  featurefile = NULL,
  featureidvar = NULL,
  featurenamevar = NULL,
  formula = NULL,
  contrastdefs = NULL,
  min_count = 10,
  pseudocount = 0.5,
  genesize = NULL,
  cpm = TRUE,
  voom = TRUE,
  log2 = TRUE,
  pca = TRUE,
  lmfit = TRUE,
  verbose = TRUE,
  plot = TRUE
)
}
\arguments{
\item{file}{count file}

\item{fid_col}{featureid fvar}

\item{samplefile}{sdata file}

\item{sampleidvar}{sampleid svar}

\item{subgroupvar}{subgroup svar}

\item{featurefile}{fdata file}

\item{featureidvar}{featureid fvar}

\item{featurenamevar}{featurename fvar}

\item{verbose}{whether to message}

\item{block}{block svar}

\item{formula}{designmat formula}

\item{contrastdefs}{contrastdef vector/matrix/list}

\item{min_count}{min feature count required in some samples}

\item{pseudocount}{added pseudocount to prevent -Inf log2 values}

\item{genesize}{genesize fvar for tpm}

\item{cpm}{whether to compute cpm}

\item{voom}{whether to compute voom precision weights}

\item{log2}{whether to log2 transform}

\item{pca}{whether to pca}

\item{lmfit}{whether to lmfit/contrast}

\item{plot}{whether to plot}
}
\value{
SummarizedExperiment
}
\description{
Read/analyze rnaseq counts
}
\examples{
# BILLING 2019
    # Read
        file <- download_data('billing19.rnacounts.txt')
        object <- .read_rnaseq_counts(file)
    # Read / Analyze
        object <-  read_rnaseq_counts(file, voom=FALSE, plot=FALSE)
    # Read / Weight / Analyze
        object <-  read_rnaseq_counts(file)

# GSE161731
   # Download
       require(magrittr)
       basedir <- '~/autonomicscache/datasets'
       subdir  <- '~/autonomicscache/datasets/GSE161731'
       if (!dir.exists(subdir))  GEOquery::getGEOSuppFiles(
                                       "GSE161731",baseDir=basedir)
       file       <- paste0(subdir,'/GSE161731_counts.csv.gz')
       samplefile <- paste0(subdir,'/GSE161731_counts_key.csv.gz')
   # Read
       object <- .read_rnaseq_counts(file, samplefile = samplefile,
                  sampleidvar ='rna_id', subgroupvar='gender')
   # Read / Analyze
       object <- read_rnaseq_counts(file, samplefile = samplefile,
         sampleidvar='rna_id', subgroupvar='gender', voom=FALSE)
   # Read / Weight / Analyze
       object <- read_rnaseq_counts(file, samplefile = samplefile,
         sampleidvar ='rna_id', subgroupvar='gender', plot = TRUE)
   # Read / Weight / Block / Analyze (dupcor takes some time)
       # object <- read_rnaseq_counts(file, samplefile = samplefile,
       #    sampleidvar='rna_id', subgroupvar='gender', block='subject_id')
}
