% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/4_plot.R
\name{plot_exprs}
\alias{plot_exprs}
\alias{plot_boxplots}
\alias{boxplot_subgroups}
\alias{plot_sample_boxplots}
\alias{boxplot_samples}
\alias{plot_feature_boxplots}
\alias{boxplot_features}
\alias{plot_exprs_per_coef}
\title{Plot exprs}
\usage{
plot_exprs(
  object,
  dim = "both",
  assay = assayNames(object)[1],
  x = switch(dim, both = "subgroup", features = "feature_id", samples = "sample_id"),
  geom = default_geom(object, x = x),
  color = x,
  fill = x,
  shape = NULL,
  size = NULL,
  block = NULL,
  linetype = NULL,
  highlight = NULL,
  fit = fits(object)[1],
  coefs = default_coefs(object, fit = fit)[1],
  combiner = "|",
  p = 1,
  fdr = 1,
  facet = if (dim == "both") "feature_id" else NULL,
  n = 4,
  ncol = NULL,
  nrow = NULL,
  scales = "free_y",
  labeller = "label_value",
  pointsize = if (is.null(block)) 0 else 0.5,
  jitter = if (is.null(block)) 0.1 else 0,
  fillpalette = make_var_palette(object, fill),
  colorpalette = make_var_palette(object, color),
  hlevels = NULL,
  title = switch(dim, both = paste0(coefs, collapse = ", "), features =
    "Feature Boxplots", samples = "Sample Boxplots"),
  xlab = NULL,
  ylab = "value",
  theme = ggplot2::theme(plot.title = element_text(hjust = 0.5)),
  file = NULL,
  width = 7,
  height = 7
)

plot_boxplots(...)

boxplot_subgroups(...)

plot_sample_boxplots(...)

boxplot_samples(...)

plot_feature_boxplots(...)

boxplot_features(...)

plot_exprs_per_coef(
  object,
  x = "subgroup",
  geom = default_geom(object, x),
  block = NULL,
  coefs = default_coefs(object),
  orderbyp = TRUE,
  title = coefs,
  nrow = 1,
  ncol = NULL,
  theme = ggplot2::theme(legend.position = "bottom", legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5))
)
}
\arguments{
\item{object}{SummarizedExperiment}

\item{dim}{'samples'   (per-sample distribution across features), \cr
'features' (per-feature distribution across samples ) or 
'both'        (subgroup distribution faceted per feature)}

\item{assay}{string: value in assayNames(object)}

\item{x}{x svar}

\item{geom}{'boxplot' or 'point'}

\item{color}{color svar: points, lines}

\item{fill}{fill svar: boxplots}

\item{shape}{shape svar}

\item{size}{size svar}

\item{block}{group svar}

\item{linetype}{linetype svar}

\item{highlight}{highlight svar}

\item{fit}{'limma', 'lm', 'lme', 'lmer', 'wilcoxon'}

\item{coefs}{subset of coefs(object) to consider in selecting top}

\item{p}{fraction: p   cutoff}

\item{fdr}{fraction: fdr cutoff}

\item{facet}{string: fvar mapped to facet}

\item{n}{number of samples (dim = 'samples') or features (dim = 'features' or 'both') to plot}

\item{ncol}{number of cols in faceted plot (if dim = 'both')}

\item{nrow}{number of rows in faceted plot (if dim = 'both)}

\item{scales}{'free_y', 'free'x', 'fixed'}

\item{labeller}{string or function}

\item{pointsize}{number}

\item{jitter}{jitter width (number)}

\item{fillpalette}{named character vector: fill palette}

\item{colorpalette}{named character vector: color palette}

\item{hlevels}{xlevels for which to plot hlines}

\item{title}{string}

\item{xlab}{string}

\item{ylab}{string}

\item{theme}{ggplot2::theme(...) or NULL}

\item{file}{NULL or filepath}

\item{width}{inches}

\item{height}{inches}
}
\value{
ggplot object
}
\description{
Plot exprs
}
\examples{
# Without limma
    file <- download_data('atkin18.metabolon.xlsx')
    object <- read_metabolon(file)
    plot_exprs(object, block = 'SUB', title = 'Subgroup Boxplots')
    plot_exprs(object, dim = 'samples')
    plot_exprs(object, dim = 'features', block = 'sample_id')
# With limma 
    object \%<>\% fit_limma(block = 'SUB')
    plot_exprs(object, block = 'SUB')
    plot_exprs(object, block = 'SUB', coefs = c('t1', 't2', 't3'))
    plot_exprs_per_coef(object, x = 'SET', block = 'SUB')
# Points
    plot_exprs(object, geom = 'point', block = 'SUB')
# Add highlights
    controlfeatures <- c('biotin','phosphate')
    fdt(object) \%<>\% cbind(control = .$feature_name \%in\% controlfeatures)
    plot_exprs(object, dim = 'samples', highlight = 'control')
# Multiple pages
    plot_exprs(object, block = 'SUB', n = 4, nrow = 1, ncol = 2)
}
\seealso{
\code{\link{plot_sample_densities}},
         \code{\link{plot_sample_violins}}
}
