% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/4_plot.R
\name{.extract_p_features}
\alias{.extract_p_features}
\alias{.extract_fdr_features}
\alias{.extract_effectsize_features}
\alias{.extract_sign_features}
\alias{.extract_n_features}
\alias{extract_coef_features}
\title{Extract coefficient features}
\usage{
.extract_p_features(
  object,
  coefs,
  sep = FITSEP,
  p = 0.05,
  fit = fits(fdt(object)),
  combiner = "|",
  verbose = TRUE
)

.extract_fdr_features(
  object,
  coefs,
  sep = FITSEP,
  fdr = 0.05,
  fit = fits(fdt(object)),
  combiner = "|",
  verbose = TRUE
)

.extract_effectsize_features(
  object,
  coefs,
  sep = FITSEP,
  effectsize = 1,
  fit = fits(fdt(object)),
  combiner = "|",
  verbose = TRUE
)

.extract_sign_features(
  object,
  coefs,
  sep = FITSEP,
  sign,
  fit = fits(fdt(object))[1],
  combiner = "|",
  verbose = TRUE
)

.extract_n_features(
  object,
  coefs,
  sep = FITSEP,
  combiner = "|",
  n,
  fit = fits(fdt(object))[1],
  verbose = TRUE
)

extract_coef_features(
  object,
  sep = FITSEP,
  fit = fits(fdt(object), sep = sep)[1],
  coefs = default_coefs(fdt(object), sep = sep, fit = fit),
  combiner = "|",
  p = 1,
  fdr = 1,
  effectsize = 0,
  sign = c(-1, +1),
  n = 4,
  verbose = TRUE
)
}
\arguments{
\item{object}{SummarizedXExperiment}

\item{coefs}{subset of coefs(object)}

\item{sep}{string}

\item{p}{p threshold}

\item{fit}{subset of fits(fdt(object))}

\item{combiner}{'|' or '&': how to combine multiple fits/coefs}

\item{verbose}{TRUE or FALSE}

\item{fdr}{fdr threshold}

\item{effectsize}{effectsize threshold}

\item{sign}{effect sign}

\item{n}{number of top features (Inf means all)}
}
\value{
SummarizedExperiment
}
\description{
Extract coefficient features
}
\examples{
# Read and Fit
    file <- download_data('atkin.metabolon.xlsx')
    object <- read_metabolon(file)
    object \%<>\% fit_limma()
# Single coef
    object0 <- object
    object \%<>\% .extract_p_features(         coefs = 't1', p = 0.05)
    object \%<>\% .extract_fdr_features(       coefs = 't1', fdr = 0.05)
    object \%<>\% .extract_effectsize_features(coefs = 't1', effectsize = 1)
    object \%<>\% .extract_sign_features(      coefs = 't1', sign = -1)
    object \%<>\% .extract_n_features(         coefs = 't1', n = 4)
    object <- object0
    object \%<>\%  extract_coef_features(coefs = 't1', p = 0.05, fdr = 0.05, effectsize = 1, sign = -1, n = 4)
# Multiple coefs
    object <- object0
    object \%<>\% .extract_p_features(         coefs = c('t1', 't2'), p = 0.05)
    object \%<>\% .extract_fdr_features(       coefs = c('t1', 't2'), fdr = 0.05)
    object \%<>\% .extract_effectsize_features(coefs = c('t1', 't2'), effectsize = 1)
    object \%<>\% .extract_sign_features(      coefs = c('t1', 't2'), sign = -1)
    object \%<>\% .extract_n_features(         coefs = c('t1', 't2'), n = 4)
    object <- object0
    object \%<>\%  extract_coef_features(coefs = c('t1', 't2'), p = 0.05, fdr = 0.05, effectsize = 1, sign = -1, n = 4)
}
