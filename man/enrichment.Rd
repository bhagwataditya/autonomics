% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_enrichment.R
\name{enrichment}
\alias{enrichment}
\title{Enrichment analysis}
\usage{
enrichment(
  object,
  pathwaydt,
  selecvar = abstractvar(object, fit = fits(object)[1], coef = coefs(object)[1]),
  genevar = "gene",
  genesep = "[ ,;]",
  n = 3,
  verbose = TRUE,
  detailed = TRUE
)
}
\arguments{
\item{object}{\code{SummarizedExperiment}}

\item{pathwaydt}{pathway \code{data.table}}

\item{selecvar}{selection fvar}

\item{genevar}{gene fvar}

\item{genesep}{gene separator (string)}

\item{verbose}{TRUE or FALSE}

\item{detailed}{whether to report results in detail}
}
\description{
Are selected genes enriched in pathway?
}
\details{
Four enrichment analyses per geneset using the Fisher Exact Test (see four pvalues).
Results are returned in a data.table
\tabular{rl}{
   in                \tab :                  genes      in pathway \cr
   in.det            \tab :         detected genes      in pathway \cr
   in.sel            \tab : up/downregulated genes      in pathway \cr
   in.up(.genes)     \tab :      upregulated genes      in pathway \cr
   in.down(.genes)   \tab :    downregulated genes      in pathway \cr
   out               \tab :                  genes outside pathway \cr
   det               \tab :         detected genes (in + out)      \cr
   sel               \tab : up/downregulated genes (in + out)      \cr
   up                \tab :      upregulated genes (in + out)      \cr
   down              \tab :    downregulated genes (in + out)      \cr
   p.coef.upDET      \tab : prob to randomly select this many (or more)   upregulated genes (among detected genes)       \cr
   p.coef.downDET    \tab : prob to randomly select this many (or more) downregulated genes (among detected genes)       \cr
   p.coef.selDET     \tab : prob to randomly select this many (or more) up OR downregulated genes (among detected genes) \cr
   p.coef.selGEN     \tab : prob to randomly select this many (or more) up OR downregulated genes (among genome   genes) \cr
   p.detGEN          \tab : prob to randomly select this many (or more) detected genes (among genome genes)
}
}
\examples{
# Read
    file <- download_data('atkin.somascan.adat')
    object <- read_somascan(file, fit = 'limma', coefs = 't1')
    fvars(object) \%<>\% gsub('EntrezGeneSymbol', 'gene', .)
    object \%<>\% abstract_fit()
# Enrichment Analysis
    pathwaydt <- read_msigdt(collections = 'gobp')
    enrichres <- enrichment(object, pathwaydt)
       altres <-  altenrich(object, pathwaydt)    # alternative implementation
    all(enrichres == altres)                      # both identical
}
