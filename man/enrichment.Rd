% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/11_enrichment.R
\name{enrichment}
\alias{enrichment}
\title{Analyze enrichment}
\usage{
enrichment(
  object,
  coldt,
  by = "gene",
  sep,
  coef = default_coefs(object)[1],
  fit = fits(object)[1],
  significancevar = "p",
  significance = 0.05,
  effectsize = 0,
  n = 3,
  verbose = TRUE,
  fast = TRUE
)
}
\arguments{
\item{object}{\code{SummarizedExperiment}}

\item{coldt}{\code{data.table}, e.g. \code{\link{read_msigdt}}}

\item{by}{\code{fvar}}

\item{sep}{\code{string} or \code{NULL}}

\item{coef}{\code{string} in \code{coefs(object)}}

\item{fit}{\code{'limma'}, \code{'lm'}, \code{'lme'}, \code{'lmer'}, \code{'wilcoxon'}}

\item{n}{no of detected genes required (for geneset to be examined)}

\item{verbose}{TRUE or FALSE}

\item{fast}{TRUE or FALSE : use fast implementation (or modular)?}

\item{p}{pvalue cutoff}
}
\description{
Are up / downregulated genes enriched in geneset?
}
\details{
Four enrichment analyses per geneset using the Fisher Exact Test (see four pvalues).
Results are returned in a data.table
\tabular{rl}{
   in                \tab :                  genes      in pathway \cr
   in.detected       \tab :         detected genes      in pathway \cr
   in.updown         \tab : up/downregulated genes      in pathway \cr
   in.up(.genes)     \tab :      upregulated genes      in pathway \cr
   in.down(.genes)   \tab :    downregulated genes      in pathway \cr
   out               \tab :                  genes outside pathway \cr
   detected          \tab :         detected genes (in + out)      \cr
   updown            \tab : up/downregulated genes (in + out)      \cr
   up                \tab :      upregulated genes (in + out)      \cr
   down              \tab :    downregulated genes (in + out)      \cr
   p.coef.up     \tab : prob to randomly select this many (or more)   upregulated genes (among detected genes)       \cr
   p.coef.down   \tab : prob to randomly select this many (or more) downregulated genes (among detected genes)       \cr
   p.coef.updown \tab : prob to randomly select this many (or more) up OR downregulated genes (among detected genes) \cr
   p.coef.naive  \tab : prob to randomly select this many (or more) up OR downregulated genes (among all genes)      \cr
   p.detected        \tab : prob to randomly select this many (or more) detected genes (among all genes)
}
}
\examples{
file <- download_data('atkin.somascan.adat')
object <- read_somascan(file, fit = 'limma')
fvars(object) \%<>\% gsub('EntrezGeneSymbol', 'gene', .)
coldt <- read_msigdt(collections = 'gobp')
coldt
enrichdt  <- enrichment(object, coldt, by = 'gene', sep = ' ')
enrichdt2 <- enrichment(object, coldt, by = 'gene', sep = ' ', fast = FALSE)
}
